# 数据库复习高阶

## 视图

视图：是基于一个表或多个表或视图的逻辑表，本身不包含数据，通过它可以对表里面的数据进行查询和修改

我们可以把一个查询包装成一个视图 这样它不包含表中应该有的任何数据和列但可以进行查询

视图具有以下优点

重用SQL语句 简化操作

维护数据的独立性，视图可从多个表检索数据 并且可以使用表的一部分 而不是整个表

视图可以返回与底层的表不同的格式 这样就对用户隐藏了数据来源于多个表的事实

通过视图可以设定允许用户访问的列和数据行，从而为表提供了额外的安全控制



```sql
creat view 视图名 AS
需要的sql语句
```

如

```sql 
creat view productcustomers as 
select cust_name, cust_contact, prod_id
from customers as c, orders as o, orderitems as or
where c.cust_id = o.cust_id
and or.order_num = or.order_num;
```

这条语句创建了一个名为productcustomers的视图，他联结三个表，返回已订购了任意产品的所有客户列表，如果执行select * from productcustomers, 将列出订购了任意产品的客户。

为了检索订购了TNT2产品的客户

```sq 
select cust_name, cust_contact from productcustomers where prod_id = 'TNT2';
```



## 存储过程

存储过程是一组为了完成特定功能的SQL 语句集

优点：

进行封装 简化复杂操作

保证数据一致性和完整性

进一步提高安全性

提高性能 因为存储过程是预编译的。在首次运行一个存储过程时查询，优化器对其进行分析优化，并且给出最终被存储在系统表中的执行计划。而批处理的Transaction-SQL语句在每次运行时都要进行编译和优化，速度相对要慢一些

执行存储过程 

```sql 
call productpricing (
    @pricelow,
    @pricehigh,
    @peiceaverage
);
```

执行名为productpricing的存储过程 计算返回产品的最低，最高和平均价格



## 游标

## 触发器

## 事物



