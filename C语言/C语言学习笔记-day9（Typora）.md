## C语言学习笔记——day9

### 作用域

作用域：作用的范围

1.普通局部变量

2.static局部变量

3.普通全局变量

4.static全局变量

5.普通函数和static函数的区别

####  1.局部变量

1.在{}内部定义的变量就是局部变量

2.只有执行到定义变量的这个语句，系统才会给这个变量分配空间

3.当离开{}，这个非static局部会自动释放

4.局部变量的作用域就是当前的{}，离开此{}，无法使用此变量

5.{}的普通局部变量，加不加auto关键词等价，普通局部变量也加自动变量，就是加不加都可以，但是在C++内部对auto有着不一样的用法

6.不同的{}中，变量名字可以一样，可以吧{}类比房子，不同房子可以有同名的小伙伴

7.普通局部变量不初始化，它的值为随机数

#### 2.static局部变量

1.static局部变量，是在编译阶段就已经分配空间，函数没有调用前，他就已经存在

2.当离开{}，static局部变量不会释放，只有程序结束，static变量才会自动释放

3.如果static局部变量不初始化，它的默认值为零

4.只有执行到第一次出现这个局部变量，变量初始化，static局部变量初始化语句，只会执行一次，但是可以赋值多次

5.static变量只能用常量初始化（注意）

举个有趣的例子：

```c
#include<stdio.h>
void fun()
{
    int i=0;
    i++;
    printf("i=%d\n",i);
}
int main()
{
   fun();
   fun();
   fun();
   return 0;
}
```

这个i是个局部变量，在函数使用完毕后自动释放，这个程序输出结果是;

```c
i=1
i=1
i=1
```

但是在static定义之后的变量就不一样了：

```c
#include<stdio.h>
void fun()
{
    static int i=0;//增加static 在编译的时候就分配内存，直到程序结束释放 static变量在data区
    i++;
    printf("i=%d\n",i);
}
int main()
{
   fun();
   fun();
   fun();
   return 0;
}
```

而这个程序输出的结果：

```c
i=1
i=2
i=3
```

两者的区别请自己多多体会哦

1.内存分配和释放

​	a）普通局部变量只有在执行到定义变量的语句才能分配空间

​	b）static局部变量在编译阶段（函数还没有执行），变量的空间已经分配

​	c）普通局部变量离开作用域{}，自动释放

​	d）static局部变量只有在整个程序结束才会自动释放

2.初始化

​	a）普通局部变量不初始化，值为随机数

​	b）static局部变量不初始化，值为0

​	c）static局部变量初始化语句只有第一次执行时有效

​	d）static局部变量只能用常量初始化

#### 3.普通全局变量（外部链接）

1.在{}外面（函数外面）定义的变量为全局变量

2.只要定义了全局变量，任何地方都能使用此变量

3.如果使用变量时，在前面找不到此全局变量的定义，我们需要声明才能使用

4.全局变量不初始化，默认赋值为0

5.声明只是针对全局变量，不是针对局部变量

6.全局变量只能定义一次，但是可以声明多次

7.全局变量在编译阶段已经分配空间（函数没有执行前），只有在整个程序运行完将释放

8.不同文件，普通全局变量只能定义一次，可以声明多次 

举个例子：

```c
 #include<stdio.h>

void fun()
{
    extern int i;//这个extern 作为声明 表示i在别的地方是已经定义过了的 在定义的时候不可以附加i的值，否则编译不会通过 
    i++;
    printf("i=%d\n",i);
}

    int i = 5;//这里依然是一个全局变量
int main()
{
   i = 11;
   fun();
   return 0;
}
```

这个程序的输出结果是12

但是C语言全局变量存在一些缺陷：

1.只有声明，没有定义，无法给变量赋值

2.如果定义一个全局变量，没有赋值（初始化），无法确定是定义，还是声明

3.如果定义一个全局变量，同时初始化，这个肯定是定义哦

```c
#include<stdio.h>

    int a;
    int a;
    int a=10;//只有这个是定义，其它都是声明
    int a;
    int a;
    //一次定义，三次声明
    int b;
    int b;
    int b;
    int b;
int main()
{
    b = 10；
   return 0;
}
```

推荐用法;

1.定义一个全局变量，建议初始化

```c
int a = 10;
```

2.如果声明一个全局变量，建议加extern

```c
extern int a;
```

 函数也是一样道理，使用之前一定需要声明

####  4.static全局变量（内部链接）

a）static全局变量和普通全局变量的区别就是作用域不一样（文件作用域）

b）extern关键字只适用于普通全局变量

c）普通全局变量，所有文件都能使用，前提需要声明

d）static全局变量只能本文件使用，别的文件不能使用

e）不同文件只能出现一个普通全局变量的定义

f）一个文件只能有一个static全局变量的定义，不同文件间的static全局变量，就算名字相同，也是没有关系的2个变量 

#### 5.普通函数和static函数的区别

a）所有文件只能有一次普通函数的定义

b）一个文件可以有一个static函数的定义

c）普通函数所有文件都能调用，前提是使用前声明

d）static函数只能在定义所在的文件使用

#### 总结

|      类型      |  作用域  |    生命周期    |
| :------------: | :------: | :------------: |
|    auto变量    | 一对{}内 |    当前函数    |
| static局部变量 | 一对{}内 | 整个程序运行期 |
|   extern变量   | 整个程序 | 整个程序运行期 |
| static全局变量 | 当前文件 | 整个程序运行期 |
|   extern函数   | 整个程序 | 整个程序运行期 |
|   static函数   | 当前文件 | 整个程序运行期 |
|  register变量  | 一对{}内 |    当前函数    |





















